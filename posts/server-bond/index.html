<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>서버 네트워크 이중화 본딩 설정(RHEL9)</title><meta name=description content="서버 신규 구축 시 네트워크 이중화 / 본딩 설정 (RHEL9 에서 실행)"><meta name=keywords content="blog,gokarna,devops"><meta property="og:url" content="https://junmanbo.github.io/posts/server-bond/"><meta property="og:type" content="website"><meta property="og:title" content="서버 네트워크 이중화 본딩 설정(RHEL9)"><meta property="og:description" content="서버 신규 구축 시 네트워크 이중화 / 본딩 설정 (RHEL9 에서 실행)"><meta property="og:image" content="https://junmanbo.github.io/images/jun_avatar.jpg"><meta property="og:image:secure_url" content="https://junmanbo.github.io/images/jun_avatar.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="서버 네트워크 이중화 본딩 설정(RHEL9)"><meta name=twitter:description content="서버 신규 구축 시 네트워크 이중화 / 본딩 설정 (RHEL9 에서 실행)"><meta property="twitter:domain" content="https://junmanbo.github.io/posts/server-bond/"><meta property="twitter:url" content="https://junmanbo.github.io/posts/server-bond/"><meta name=twitter:image content="https://junmanbo.github.io/images/jun_avatar.jpg"><link rel=canonical href=https://junmanbo.github.io/posts/server-bond/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.cefb5c919f4ebc418ee0e029999287fe65e11ce055c339659760dca723cb575b.js integrity="sha256-zvtckZ9OvEGO4OApmZKH/mXhHOBVwzlll2DcpyPLV1s="></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://junmanbo.github.io><img src=/images/jun_avatar.jpg alt="Kim Byeong Jun"></a></div><div class=nav-title><a class=nav-brand href=https://junmanbo.github.io>Jun's Blog</a></div><div class=nav-links><div class=nav-link><a href=https://junmanbo.github.io/ aria-label><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://junmanbo.github.io/posts/ aria-label><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://junmanbo.github.io/projects/ aria-label><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://junmanbo.github.io/tags/ aria-label><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/junmanbo aria-label=github><span data-feather=github></span></a></div><div class=nav-link><a href=https://junmanbo.github.io/index.xml aria-label=rss><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://junmanbo.github.io/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://junmanbo.github.io/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://junmanbo.github.io/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://junmanbo.github.io/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/junmanbo><span data-feather=github></span></a></li><li class=nav-item><a href=https://junmanbo.github.io/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>서버 네트워크 이중화 본딩 설정(RHEL9)</h1><small role=doc-subtitle>서버 신규 구축 시 네트워크 이중화 / 본딩 설정 (RHEL9 에서 실행)</small><p class=post-date>May 4, 2025</p><ul class=post-tags></ul></div><div class=post-content><h2 id=1-rhel-9-서버-신규-구축-시-네트워크-본딩-구성-방법-active-backup-구성>1. RHEL 9 서버 신규 구축 시 네트워크 본딩 구성 방법 (active-backup 구성)</h2><p>안녕하세요 오늘은 **RHEL 9 서버를 새로 구축하면서 네트워크 본딩(Network Bonding)**을 설정했던 과정을 공유해보려고 합니다. 서버에 네트워크 카드가 2장이 장착되어 있고, 이를 하나의 논리적 인터페이스로 묶어 고가용성과 이중화를 구성하는 게 목표였습니다.</p><p>특히 저는 active-backup 모드를 사용하면서 primary_reselect=failure 옵션을 설정해, 장애 복구 시 불필요한 네트워크 스위칭을 방지하고 싶었습니다. 그 과정과 설정 방법을 단계별로 정리해볼게요.</p><p>네트워크 본딩은 두 개 이상의 물리적 네트워크 인터페이스를 하나의 논리적 인터페이스로 묶어주는 기술입니다. 이를 통해 다음과 같은 장점을 얻을 수 있습니다:</p><p>고가용성(High Availability): 한 쪽 네트워크에 장애가 나도 다른 쪽으로 자동 전환</p><ul><li>로드 밸런싱: 트래픽을 여러 인터페이스에 분산</li><li>대역폭 증가: 물리적 인터페이스의 대역폭을 합산</li></ul><p>저는 이번 구축에서 고가용성 목적으로 본딩을 설정했습니다.</p><h2 id=2-본딩-모드-종류>2. 본딩 모드 종류</h2><p>본딩에는 여러 가지 모드가 있으며, 각각의 특징과 동작 방식이 다릅니다. 아래 표로 정리해봤습니다.</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>모드 번호</td><td>모드 이름</td><td>설명</td></tr><tr><td>0</td><td>balance-rr</td><td>라운드 로빈 방식. 모든 인터페이스에 순차적으로 트래픽 전송.</td></tr><tr><td>1</td><td>active-backup</td><td>하나의 인터페이스 active. 장애 시 backup으로 전환.</td></tr><tr><td>2</td><td>balance-xor</td><td>송수신 해시 기반으로 트래픽 분산.</td></tr><tr><td>3</td><td>broadcast</td><td>모든 인터페이스에 동일한 패킷 전송.</td></tr><tr><td>4</td><td>802.3ad (LACP)</td><td>IEEE 802.3ad (LACP) 기반 링크 집계. 스위치 설정 필요.</td></tr><tr><td>5</td><td>balance-tlb</td><td>송신 부하 분산. 수신은 단일 인터페이스로 수신.</td></tr><tr><td>6</td><td>balance-alb</td><td>송수신 모두 부하 분산.</td></tr></tbody></table><p>참고: 일반적으로 스위치 설정 없이 고가용성을 원할 땐 **mode=1 (active-backup)**을 많이 사용합니다.</p><h2 id=3-ethtool로-인터페이스-확인>3. ethtool로 인터페이스 확인</h2><p>본딩 설정 전에 어떤 인터페이스를 사용할지 정확히 확인해야 합니다. 저는 ethtool 명령어를 사용했습니다.</p><p><code>ethtool eno1</code>
<code>ethtool ensfo1</code></p><p>출력 결과에서 <strong>Link detected: yes</strong>로 연결 여부를 확인하고, 속도(Speed), 드라이버 정보도 함께 확인했습니다. 이 과정으로 실제 연결된 인터페이스와 속성을 파악할 수 있습니다.</p><h2 id=4-primary-인터페이--primary_reselect-옵션-설정>4. primary 인터페이 + primary_reselect 옵션 설정</h2><p>active-backup 모드에서는 기본적으로 primary_reselect=always 옵션이 적용됩니다. 이 옵션은 primary 인터페이스가 복구되면 무조건 active로 다시 전환되도록 만듭니다.</p><p>지만 저는 이렇게 설정하면 복구 시 네트워크 스위칭 과정에서 ping 유실, 순간적 연결 끊김 현상이 발생한다는 문제를 발견했습니다. 이를 방지하기 위해 다음과 같은 설정을 원했습니다:</p><ul><li>eno1: primary (초기 active)</li><li>ensfo1: backup</li><li>eno1 장애 시 → ensfo1 active</li><li>eno1 복구해도 active는 ensfo1 유지</li><li>이후 ensfo1 장애 시 → eno1로 active 전환</li></ul><p>이렇게 하려면 primary_reselect=failure 옵션을 설정해야 합니다.</p><p>primary_reselect 옵션 종류
참고로 primary_reselect에는 아래와 같은 값이 있습니다:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>옵션 이름</td><td>설명</td></tr><tr><td>always</td><td>primary가 복구되면 무조건 primary로 active 전환 (기본값)</td></tr><tr><td>better</td><td>primary가 복구되고 성능(링크 속도, duplex 등)이 더 좋으면 active 전환</td></tr><tr><td>failure</td><td>primary가 장애 상태였다가 복구될 때만 active 전환</td></tr></tbody></table><p>저는 <strong>failure</strong>로 설정하여 불필요한 active 전환을 방지했습니다.</p><h2 id=5-nmcli를-이용한-본딩-설정>5. nmcli를 이용한 본딩 설정</h2><p>이제 실제로 nmcli를 이용해 본딩을 설정한 과정을 정리해볼게요.</p><p>① 본딩 인터페이스 생성
<code>nmcli connection add type bond con-name bond0 ifname bond0 mode active-backup</code>
bond0이라는 이름으로 본딩 인터페이스를 생성하고, active-backup 모드를 지정했습니다.</p><p>② primary, primary_reselect 옵션 지정
`nmcli connection modify bond0 bond.options &ldquo;primary=eno1 primary_reselect=failure&rdquo;</p><p>이 명령어로 eno1을 primary로 지정하고, primary_reselect=failure를 적용했습니다.</p><p>③ IP 주소 설정</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmcli connection modify bond0 ipv4.addresses 192.168.1.100/24
</span></span><span style=display:flex><span>nmcli connection modify bond0 ipv4.gateway 192.168.1.1
</span></span><span style=display:flex><span>nmcli connection modify bond0 ipv4.method manual
</span></span></code></pre></div><p>IP 주소와 게이트웨이를 수동으로 설정했습니다.</p><p>④ 슬레이브 인터페이스 추가</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmcli connection add type ethernet con-name eno1-slave ifname eno1 master bond0
</span></span><span style=display:flex><span>nmcli connection add type ethernet con-name ensfo1-slave ifname ensfo1 master bond0
</span></span></code></pre></div><p>본딩에 eno1, ensfo1을 슬레이브 인터페이스로 추가합니다.</p><p>⑤ 연결 활성화</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mcli connection up eno1-slave
</span></span><span style=display:flex><span>nmcli connection up ensfo1-slave
</span></span><span style=display:flex><span>nmcli connection up bond0
</span></span></code></pre></div><p>모든 연결을 활성화하여 설정을 적용했습니다.</p><h2 id=6-설정-확인>6. 설정 확인</h2><p>설정 완료 후 본딩 상태는 아래 명령어로 확인했습니다:</p><p><code>cat /proc/net/bonding/bond0</code></p><p>여기서 현재 active 인터페이스, primary 설정 등을 확인할 수 있습니다.</p><h2 id=7-장애-테스트>7. 장애 테스트</h2><p>설정 테스트를 위해 ethtool로 링크 다운 시뮬레이션을 했습니다:</p><p><code>ethtool -s eno1 down</code></p><p>→ eno1 장애 발생 → ensfo1로 active 전환</p><p><code>ethtool -s eno1 up</code></p><p>→ eno1 복구 → active는 여전히 ensfo1 유지</p><p>이렇게 설정하면 불필요한 네트워크 스위칭 없이 안정적으로 failover 동작을 구현할 수 있었습니다.</p><p>마치며</p><p>이번 구축 과정에서 느낀 점은, 본딩은 단순히 인터페이스를 묶는 것 이상으로 장애 상황 시 네트워크 동작 방식을 어떻게 정의할지에 대한 고민이 필요하다는 점입니다. primary_reselect 같은 세부 옵션 하나로도 실제 장애 대응 방식이 크게 달라질 수 있더라고요</p></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg><script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#1-rhel-9-서버-신규-구축-시-네트워크-본딩-구성-방법-active-backup-구성>1. RHEL 9 서버 신규 구축 시 네트워크 본딩 구성 방법 (active-backup 구성)</a></li><li><a href=#2-본딩-모드-종류>2. 본딩 모드 종류</a></li><li><a href=#3-ethtool로-인터페이스-확인>3. ethtool로 인터페이스 확인</a></li><li><a href=#4-primary-인터페이--primary_reselect-옵션-설정>4. primary 인터페이 + primary_reselect 옵션 설정</a></li><li><a href=#5-nmcli를-이용한-본딩-설정>5. nmcli를 이용한 본딩 설정</a></li><li><a href=#6-설정-확인>6. 설정 확인</a></li><li><a href=#7-장애-테스트>7. 장애 테스트</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2025 The Kim Byeong Jun</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer></body></html>